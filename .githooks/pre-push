#!/bin/sh

echo "üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è..."

# –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
git add .

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —á—Ç–æ –∫–æ–º–º–∏—Ç–∏—Ç—å
if ! git diff --cached --quiet; then
    echo "üì¶ –ï—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è, —Å–æ–∑–¥–∞—ë–º –∫–æ–º–º–∏—Ç..."
    git commit -m "auto commit $(date)"
else
    echo "‚úÖ –ù–µ—Ç –Ω–æ–≤—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π"
fi

echo "üõ†Ô∏è –ó–∞–ø—É—Å–∫–∞–µ–º —Å–±–æ—Ä–∫—É..."
npm run build

if [ $? -ne 0 ]; then
    echo "‚ùå –°–±–æ—Ä–∫–∞ —É–ø–∞–ª–∞! –ü—É—à –æ—Ç–º–µ–Ω—ë–Ω. –ò—Å–ø—Ä–∞–≤—å –æ—à–∏–±–∫–∏ –∏ –ø—Ä–æ–±—É–π —Å–Ω–æ–≤–∞."
    exit 1
fi

echo "‚úÖ –°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞, –ø—É—à–∏–º..."
exit 0